Load student with lora rank: 8
Student use lora: True
Detected model type: llava_qwen2
Determined model backbone: llava_qwen2
Student model built.
Load teacher with lora rank: 8
Teacher use lora: True
Detected model type: qwen2_vl
Determined model backbone: qwen2_vl
Teacher model loaded.
Projector t2s_img created with structure: Sequential(
  (0): Linear(in_features=1536, out_features=896, bias=True)
)
Projector t2s_txt created with structure: Sequential(
  (0): Linear(in_features=1536, out_features=896, bias=True)
)
Projectors set.
Loaded 7835 samples from TIGER-Lab/MMEB-train with subsets ['CIRR']
Processor load here for LLAVA-QWEN2
Student processor loaded.
Load Qwen2-VL processor
>>>>>>>>>>>>>>>>>>>>>>>> Processor raghavlite/B3_Qwen2_2B
ImageProcessor type: <class 'transformers.models.qwen2_vl.image_processing_qwen2_vl.Qwen2VLImageProcessor'>
teacher processor loaded here.
Teacher processor loaded.
Len of train dataset: 7835
Projector parameters added to optimizer.
[StrongerKD] rkd_loss_weight: 0.0, simple_kd_weight: 0.3, intra_rkd_weight: 0.3, img_align_loss_weight: 0.0, cross_modal_kd_weight: 0.002, ot_loss_weight: 0.03
Load student with lora rank: 8
Student use lora: True
Detected model type: llava_qwen2
Determined model backbone: llava_qwen2
Student model built.
Load teacher with lora rank: 8
Teacher use lora: True
Detected model type: qwen2_vl
Determined model backbone: qwen2_vl
Teacher model loaded.
Projector t2s_img created with structure: Sequential(
  (0): Linear(in_features=1536, out_features=896, bias=True)
)
Projector t2s_txt created with structure: Sequential(
  (0): Linear(in_features=1536, out_features=896, bias=True)
)
Projectors set.
Loaded 7835 samples from TIGER-Lab/MMEB-train with subsets ['CIRR']
Processor load here for LLAVA-QWEN2
Student processor loaded.
Load Qwen2-VL processor
>>>>>>>>>>>>>>>>>>>>>>>> Processor raghavlite/B3_Qwen2_2B
ImageProcessor type: <class 'transformers.models.qwen2_vl.image_processing_qwen2_vl.Qwen2VLImageProcessor'>
teacher processor loaded here.
Teacher processor loaded.
Len of train dataset: 7835
Projector parameters added to optimizer.
[StrongerKD] rkd_loss_weight: 0.0, simple_kd_weight: 0.3, intra_rkd_weight: 0.3, img_align_loss_weight: 0.0, cross_modal_kd_weight: 0.002, ot_loss_weight: 0.06
Load student with lora rank: 8
Student use lora: True
Detected model type: llava_qwen2
Determined model backbone: llava_qwen2
Student model built.
Load teacher with lora rank: 8
Teacher use lora: True
Detected model type: qwen2_vl
Determined model backbone: qwen2_vl
Teacher model loaded.
Projector t2s_img created with structure: Sequential(
  (0): Linear(in_features=1536, out_features=896, bias=True)
)
Projector t2s_txt created with structure: Sequential(
  (0): Linear(in_features=1536, out_features=896, bias=True)
)
Projectors set.
Loaded 7835 samples from TIGER-Lab/MMEB-train with subsets ['CIRR']
Processor load here for LLAVA-QWEN2
Student processor loaded.
Load Qwen2-VL processor
>>>>>>>>>>>>>>>>>>>>>>>> Processor raghavlite/B3_Qwen2_2B
ImageProcessor type: <class 'transformers.models.qwen2_vl.image_processing_qwen2_vl.Qwen2VLImageProcessor'>
teacher processor loaded here.
Teacher processor loaded.
Len of train dataset: 7835
Projector parameters added to optimizer.
[StrongerKD] rkd_loss_weight: 0.0, simple_kd_weight: 0.3, intra_rkd_weight: 0.3, img_align_loss_weight: 0.0, cross_modal_kd_weight: 0.002, ot_loss_weight: 0.09
Load student with lora rank: 8
Student use lora: True
Detected model type: llava_qwen2
Determined model backbone: llava_qwen2
Student model built.
Load teacher with lora rank: 8
Teacher use lora: True
Detected model type: qwen2_vl
Determined model backbone: qwen2_vl
Teacher model loaded.
Projector t2s_img created with structure: Sequential(
  (0): Linear(in_features=1536, out_features=896, bias=True)
)
Projector t2s_txt created with structure: Sequential(
  (0): Linear(in_features=1536, out_features=896, bias=True)
)
Projectors set.
Loaded 7835 samples from TIGER-Lab/MMEB-train with subsets ['CIRR']
Processor load here for LLAVA-QWEN2
Student processor loaded.
Load Qwen2-VL processor
>>>>>>>>>>>>>>>>>>>>>>>> Processor raghavlite/B3_Qwen2_2B
ImageProcessor type: <class 'transformers.models.qwen2_vl.image_processing_qwen2_vl.Qwen2VLImageProcessor'>
teacher processor loaded here.
Teacher processor loaded.
Len of train dataset: 7835
Projector parameters added to optimizer.
[StrongerKD] rkd_loss_weight: 0.0, simple_kd_weight: 0.3, intra_rkd_weight: 0.3, img_align_loss_weight: 0.0, cross_modal_kd_weight: 0.004, ot_loss_weight: 0.03
Load student with lora rank: 8
Student use lora: True
Detected model type: llava_qwen2
Determined model backbone: llava_qwen2
Student model built.
Load teacher with lora rank: 8
Teacher use lora: True
Detected model type: qwen2_vl
Determined model backbone: qwen2_vl
Teacher model loaded.
Projector t2s_img created with structure: Sequential(
  (0): Linear(in_features=1536, out_features=896, bias=True)
)
Projector t2s_txt created with structure: Sequential(
  (0): Linear(in_features=1536, out_features=896, bias=True)
)
Projectors set.
Loaded 7835 samples from TIGER-Lab/MMEB-train with subsets ['CIRR']
Processor load here for LLAVA-QWEN2
Student processor loaded.
Load Qwen2-VL processor
>>>>>>>>>>>>>>>>>>>>>>>> Processor raghavlite/B3_Qwen2_2B
ImageProcessor type: <class 'transformers.models.qwen2_vl.image_processing_qwen2_vl.Qwen2VLImageProcessor'>
teacher processor loaded here.
Teacher processor loaded.
Len of train dataset: 7835
Projector parameters added to optimizer.
[StrongerKD] rkd_loss_weight: 0.0, simple_kd_weight: 0.3, intra_rkd_weight: 0.3, img_align_loss_weight: 0.0, cross_modal_kd_weight: 0.004, ot_loss_weight: 0.06
Load student with lora rank: 8
Student use lora: True
Detected model type: llava_qwen2
Determined model backbone: llava_qwen2
Student model built.
Load teacher with lora rank: 8
Teacher use lora: True
Detected model type: qwen2_vl
Determined model backbone: qwen2_vl
Teacher model loaded.
Projector t2s_img created with structure: Sequential(
  (0): Linear(in_features=1536, out_features=896, bias=True)
)
Projector t2s_txt created with structure: Sequential(
  (0): Linear(in_features=1536, out_features=896, bias=True)
)
Projectors set.
Loaded 7835 samples from TIGER-Lab/MMEB-train with subsets ['CIRR']
Processor load here for LLAVA-QWEN2
Student processor loaded.
Load Qwen2-VL processor
>>>>>>>>>>>>>>>>>>>>>>>> Processor raghavlite/B3_Qwen2_2B
ImageProcessor type: <class 'transformers.models.qwen2_vl.image_processing_qwen2_vl.Qwen2VLImageProcessor'>
teacher processor loaded here.
Teacher processor loaded.
Len of train dataset: 7835
Projector parameters added to optimizer.
[StrongerKD] rkd_loss_weight: 0.0, simple_kd_weight: 0.3, intra_rkd_weight: 0.6, img_align_loss_weight: 0.0, cross_modal_kd_weight: 0.002, ot_loss_weight: 0.03
